<div class="products-page">
  <div class="products-header">
    <h1>Our Products</h1>
    <p class="subtitle">Discover our amazing collection</p>
  </div>

  <!-- Modern Filters -->
  <app-modern-filters
    [initialFilters]="{
      search: '',
      category: 'all',
      minPrice: 0,
      maxPrice: 100,
      sortBy: filterForm.get('ordering')?.value || '-created_at',
      minRating: filterForm.get('minRating')?.value || 0
    }"
    (filtersChange)="onFiltersChange($event)"
    (clearFilters)="onClearFilters()">
  </app-modern-filters>

  <!-- Loading State -->
  <div *ngIf="loading$ | async" class="loading-container">
    <mat-spinner diameter="60"></mat-spinner>
    <p>Loading products...</p>
  </div>

  <!-- Error State -->
  <div *ngIf="error$ | async as error" class="error-container">
    <mat-card class="error-card">
      <mat-card-content>
        <mat-icon color="warn" class="error-icon">error_outline</mat-icon>
        <h3>Oops! Something went wrong</h3>
        <p>{{ error }}</p>
        <button mat-raised-button color="primary" (click)="loadProducts()">
          Try Again
        </button>
      </mat-card-content>
    </mat-card>
  </div>

  <!-- Products Grid -->
  <div *ngIf="!(loading$ | async) && !(error$ | async)" class="products-section">
    <app-products-list
      [products]="(products$ | async) || []"
      [loading]="false"
      [error]="null">
    </app-products-list>

    <!-- Pagination -->
    <div class="pagination-container">
      <mat-paginator
        [length]="count$ | async"
        [pageSize]="(filterForm.get('pageSize')?.value) || 12"
        [pageIndex]="((filterForm.get('page')?.value) || 1) - 1"
        [pageSizeOptions]="[12, 24, 48, 96]"
        (page)="onPageChange($event)"
        showFirstLastButtons>
      </mat-paginator>
    </div>
  </div>
</div>
